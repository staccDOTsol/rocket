"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[149],{4149:function(e,r,t){t.d(r,{W:function(){return U},u:function(){return A}});var n=t(6835),s=t(7812),a=t(29),o=t(4389),c=t(7794),i=t.n(c),u=t(7294),l=t(2777),d=t(2262),p=t(9499),m=t(3550),f=t.n(m),b=t(9593),h=function(){function e(){(0,l.Z)(this,e),(0,p.Z)(this,"discriminator",0),(0,p.Z)(this,"kind","Rock")}return(0,d.Z)(e,[{key:"toJSON",value:function(){return{kind:"Rock"}}},{key:"toEncodable",value:function(){return{Rock:{}}}}]),e}();(0,p.Z)(h,"discriminator",0),(0,p.Z)(h,"kind","Rock");var g=function(){function e(){(0,l.Z)(this,e),(0,p.Z)(this,"discriminator",1),(0,p.Z)(this,"kind","Paper")}return(0,d.Z)(e,[{key:"toJSON",value:function(){return{kind:"Paper"}}},{key:"toEncodable",value:function(){return{Paper:{}}}}]),e}();(0,p.Z)(g,"discriminator",1),(0,p.Z)(g,"kind","Paper");var y=function(){function e(){(0,l.Z)(this,e),(0,p.Z)(this,"discriminator",2),(0,p.Z)(this,"kind","Scissors")}return(0,d.Z)(e,[{key:"toJSON",value:function(){return{kind:"Scissors"}}},{key:"toEncodable",value:function(){return{Scissors:{}}}}]),e}();function v(e){var r=b.rustEnum([b.struct([],"Rock"),b.struct([],"Paper"),b.struct([],"Scissors")]);return void 0!==e?r.replicate(e):r}(0,p.Z)(y,"discriminator",2),(0,p.Z)(y,"kind","Scissors");var k=t(9917),P=new k.PublicKey("7vWEUWH7L9VJCZjVahFwpWstZqfmGTSK122VVtvdvzFz"),x=t(8764).Buffer,w=function(){var e,r;function t(e){(0,l.Z)(this,t),(0,p.Z)(this,"bump",void 0),(0,p.Z)(this,"board",void 0),(0,p.Z)(this,"isOpen",void 0),(0,p.Z)(this,"numPieces",void 0),(0,p.Z)(this,"numPlayersTotal",void 0),(0,p.Z)(this,"numPlayersRock",void 0),(0,p.Z)(this,"numPlayersPaper",void 0),(0,p.Z)(this,"numPlayersScissors",void 0),(0,p.Z)(this,"startedAt",void 0),this.bump=e.bump,this.board=e.board,this.isOpen=e.isOpen,this.numPieces=e.numPieces,this.numPlayersTotal=e.numPlayersTotal,this.numPlayersRock=e.numPlayersRock,this.numPlayersPaper=e.numPlayersPaper,this.numPlayersScissors=e.numPlayersScissors,this.startedAt=e.startedAt}return(0,d.Z)(t,[{key:"toJSON",value:function(){return{bump:this.bump,board:this.board.map(function(e){return e.map(function(e){return e.toJSON()})}),isOpen:this.isOpen,numPieces:this.numPieces.toString(),numPlayersTotal:this.numPlayersTotal.toString(),numPlayersRock:this.numPlayersRock.toString(),numPlayersPaper:this.numPlayersPaper.toString(),numPlayersScissors:this.numPlayersScissors.toString(),startedAt:this.startedAt.toString()}}}],[{key:"fetch",value:(e=(0,a.Z)(i().mark(function e(r,t){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getAccountInfo(t);case 2:if(null!==(n=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:if(n.owner.equals(P)){e.next=7;break}throw Error("account doesn't belong to this program");case 7:return e.abrupt("return",this.decode(n.data));case 8:case"end":return e.stop()}},e,this)})),function(r,t){return e.apply(this,arguments)})},{key:"fetchMultiple",value:(r=(0,a.Z)(i().mark(function e(r,t){var n,s=this;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getMultipleAccountsInfo(t);case 2:return n=e.sent,e.abrupt("return",n.map(function(e){if(null===e)return null;if(!e.owner.equals(P))throw Error("account doesn't belong to this program");return s.decode(e.data)}));case 4:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})},{key:"decode",value:function(e){if(!e.slice(0,8).equals(t.discriminator))throw Error("invalid account discriminator");var r=t.layout.decode(e.slice(8));return new t({bump:r.bump,board:r.board.map(function(e){return e.map(function(e){return function(e){if("object"!=typeof e)throw console.log(e),Error("Invalid enum object");if(!e)return 0;if(console.log(e),"Rock"in e)return 1;if("Paper"in e)return 2;if("Scissors"in e)return 3;throw Error("Invalid enum object")}(e)})}),isOpen:r.isOpen,numPieces:r.numPieces,numPlayersTotal:r.numPlayersTotal,numPlayersRock:r.numPlayersRock,numPlayersPaper:r.numPlayersPaper,numPlayersScissors:r.numPlayersScissors,startedAt:r.startedAt})}},{key:"fromJSON",value:function(e){return new t({bump:e.bump,board:e.board.map(function(e){return e.map(function(e){return function(e){switch(e.kind){case"Rock":return new h;case"Paper":return new g;case"Scissors":return new y}}(e)})}),isOpen:e.isOpen,numPieces:new(f())(e.numPieces),numPlayersTotal:new(f())(e.numPlayersTotal),numPlayersRock:new(f())(e.numPlayersRock),numPlayersPaper:new(f())(e.numPlayersPaper),numPlayersScissors:new(f())(e.numPlayersScissors),startedAt:new(f())(e.startedAt)})}}]),t}();(0,p.Z)(w,"discriminator",x.from([27,90,166,125,74,100,121,18])),(0,p.Z)(w,"layout",b.struct([b.u8("bump"),b.vec(b.vec(b.option(v())),"board"),b.bool("isOpen"),b.u64("numPieces"),b.u64("numPlayersTotal"),b.u64("numPlayersRock"),b.u64("numPlayersPaper"),b.u64("numPlayersScissors"),b.i64("startedAt")]));var S=t(9828),j=t(4306),O=t(4718),Z=(0,t(4671).Z)(function(e,r){var t;return{balance:0,getUserSOLBalance:(t=(0,a.Z)(i().mark(function r(t,n){var s;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s=0,r.prev=1,r.next=4,n.getBalance(t,"confirmed");case 4:s=r.sent/k.LAMPORTS_PER_SOL,r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),console.log("error getting balance: ",r.t0);case 11:e(function(e){e.balance=s,console.log("balance updated, ",s)});case 12:case"end":return r.stop()}},r,null,[[1,8]])})),function(e,r){return t.apply(this,arguments)})}});t(8764).Buffer,t(8764).Buffer,b.struct([b.u64("x"),b.u64("y")]);var N=t(8764).Buffer,T=b.struct([v("team")]),B=t(8764).Buffer,K=b.struct([b.u64("x"),b.u64("y")]);t(8764).Buffer;var R=t(5893),E=t(8764).Buffer,W=new k.PublicKey("3XXuUFfweXBwFgFfYaejLvZE4cGZiHgKiGfMtdxNzYmv"),A=function(e){(0,o.Z)(e);var r=(0,u.useState)(),t=(r[0],r[1]),c=(0,j.O)(),l=(0,O.R)().connection;Z(function(e){return e.balance});var d=new S.Y7(l,c,{preflightCommitment:"recent"}),p=Z().getUserSOLBalance,m=(0,u.useState)(function(){for(var e=[],r=0;r<64;r++){for(var t=[],n=0;n<64;n++)t.push(0);e.push(t)}return e}),f=m[0],b=m[1],h=k.PublicKey.findProgramAddressSync([E.from("game")],P)[0];(0,u.useEffect)(function(){c.connected&&setTimeout((0,a.Z)(i().mark(function e(){var r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.fetch(l,h);case 2:return r=e.sent,e.t0=t,e.next=6,w.fetch(l,h);case 6:e.t1=e.sent,(0,e.t0)(e.t1),r&&(console.log(r.numPieces.toNumber()),console.log(r.board),b(r.board));case 9:case"end":return e.stop()}},e)})),2e3)},[h]);var g=(0,u.useState)(),y=g[0],v=g[1];return(0,u.useEffect)(function(){c.connected&&y&&setTimeout((0,a.Z)(i().mark(function e(){var r,t,n,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(y),r=k.PublicKey.findProgramAddressSync([E.from("player"),c.publicKey.toBuffer()],P)[0],e.next=4,function(e,r){var t=[{pubkey:r.authority,isSigner:!0,isWritable:!0},{pubkey:r.game,isSigner:!1,isWritable:!0},{pubkey:r.player,isSigner:!1,isWritable:!0},{pubkey:r.systemProgram,isSigner:!1,isWritable:!1}],n=N.from([53,6,141,90,215,247,26,80]),s=N.alloc(1e3),a=T.encode({team:1==e.team?{Rock:{}}:2==e.team?{Paper:{}}:3==e.team?{Scissors:{}}:null},s),o=N.concat([n,s]).slice(0,8+a);return new k.TransactionInstruction({keys:t,programId:P,data:o})}({team:"scissors"==y?3:"paper"==y?2:1},{authority:c.publicKey,game:h,player:r,systemProgram:k.SystemProgram.programId});case 4:return t=e.sent,n=k.ComputeBudgetProgram.requestUnits({units:21e5,additionalFee:0}),(s=new k.Transaction().add(n).add(t)).feePayer=c.publicKey,e.next=10,l.getRecentBlockhash();case 10:return s.recentBlockhash=e.sent.blockhash,e.next=13,d.sendAndConfirm(s,[],{skipPreflight:!0});case 13:case"end":return e.stop()}},e)})),2e3)},[y]),(0,u.useEffect)(function(){c.publicKey&&(console.log(c.publicKey.toBase58()),p(c.publicKey,l))},[c.publicKey,l,p]),(0,R.jsx)("div",{className:"md:hero mx-auto p-4",children:(0,R.jsx)("div",{className:"md:hero-content flex flex-col",children:(0,R.jsx)("div",{className:"flex flex-col mt-2",children:(0,R.jsx)(function(){var e,r=(e=(0,a.Z)(i().mark(function e(r,t){var a,o,u,p,m,g,v,x,j,O;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(r),b(a=(0,s.Z)(f)),u=0,e.t0=y,e.next="rock"===e.t0?7:"paper"===e.t0?10:"scissors"===e.t0?13:16;break;case 7:return u=1,o="rock",e.abrupt("break",18);case 10:return u=2,o="paper",e.abrupt("break",18);case 13:return u=3,o="scissors",e.abrupt("break",18);case 16:return o="rock",e.abrupt("break",18);case 18:return a[r][t]=u,new Date().getTime(),p=k.PublicKey.findProgramAddressSync([E.from("player"),c.publicKey.toBuffer()],P)[0],Math.floor(9999999*Math.random()).toString(),e.t1=k.PublicKey,e.t2=E.from("thread","utf-8"),e.t3=h.toBuffer(),e.t4=E,e.next=30,w.fetch(l,h);case 30:return e.t5=e.sent.numPieces.toString(),e.t6=e.t4.from.call(e.t4,e.t5),e.t7=[e.t2,e.t3,e.t6],e.t8=W,m=e.t1.findProgramAddressSync.call(e.t1,e.t7,e.t8),console.log((g=(0,n.Z)(m,1)[0]).toBase58()),v=new k.Transaction,console.log(u),console.log(u),console.log(u),console.log(u),console.log(u),e.t9=console,e.next=47,w.fetch(l,h);case 47:return e.t10=e.sent.numPieces.toNumber(),e.t9.log.call(e.t9,e.t10),e.t11=k.PublicKey,e.t12=E.from("piece"),e.next=53,w.fetch(l,h);case 53:return e.t13=e.sent.numPieces.toArray("le",8),e.t14=[e.t12,e.t13],e.t15=P,x=e.t11.findProgramAddressSync.call(e.t11,e.t14,e.t15)[0],e.next=59,function(e,r){var t=[{pubkey:r.authority,isSigner:!1,isWritable:!0},{pubkey:r.game,isSigner:!1,isWritable:!0},{pubkey:r.piece,isSigner:!1,isWritable:!0},{pubkey:r.player,isSigner:!1,isWritable:!0},{pubkey:r.systemProgram,isSigner:!1,isWritable:!1},{pubkey:r.thread,isSigner:!1,isWritable:!0},{pubkey:r.threadProgram,isSigner:!1,isWritable:!1}],n=B.from([136,17,68,212,182,62,108,151]),s=B.alloc(1e3),a=K.encode({x:e.x,y:e.y},s),o=B.concat([n,s]).slice(0,8+a);return new k.TransactionInstruction({keys:t,programId:P,data:o})}({x:new S.BN(r),y:new S.BN(t)},{authority:c.publicKey,game:h,piece:x,player:p,systemProgram:k.SystemProgram.programId,thread:g,threadProgram:W});case 59:return j=e.sent,O=k.ComputeBudgetProgram.requestUnits({units:21e5,additionalFee:0}),e.prev=61,v.add(O),v.add(j),v.feePayer=c.publicKey,e.next=67,l.getRecentBlockhash();case 67:return v.recentBlockhash=e.sent.blockhash,e.next=70,d.sendAndConfirm(v,[],{skipPreflight:!0});case 70:e.next=75;break;case 72:e.prev=72,e.t16=e.catch(61),console.log(e.t16);case 75:a[r][t]=o,b(a);case 77:case"end":return e.stop()}},e,null,[[61,72]])})),function(r,t){return e.apply(this,arguments)});return(0,R.jsxs)("div",{className:"board-container",children:[(0,R.jsx)(function(e){var r=e.onSelectOption,t=e.currentOption;return(0,R.jsxs)("div",{className:"options",children:[(0,R.jsx)("button",{style:{backgroundColor:"red"},className:"option ".concat("rock"===t?"selected":""),onClick:function(){return r("rock")},children:"Rock"}),(0,R.jsx)("br",{}),(0,R.jsx)("button",{style:{backgroundColor:"blue"},className:"option ".concat("paper"===t?"selected":""),onClick:function(){return r("paper")},children:"Paper"}),(0,R.jsx)("br",{}),(0,R.jsx)("button",{style:{backgroundColor:"yellow"},className:"option ".concat("scissors"===t?"selected":""),onClick:function(){return r("scissors")},children:"Scissors"}),(0,R.jsx)("br",{})]})},{onSelectOption:v,currentOption:y}),(0,R.jsx)("div",{className:"board",children:f.map(function(e,t){return(0,R.jsx)("div",{className:"row",children:e.map(function(e,n){return(0,R.jsx)("div",{className:3==e?"square clicked-3":1==e?"square clicked-1":2==e?"square clicked-2":"square"+" cell-".concat(t,"-").concat(n),onClick:function(){return r(t,n)}},"".concat(t,"-").concat(n))})},t)})})]})},{})})})})},C=t(5866),M=t(7191),I=t.n(M),q=t(1118),D=function(){var e=(0,j.O)(),r=e.publicKey,t=e.signMessage,n=(0,u.useCallback)((0,a.Z)(i().mark(function e(){var n,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=3;break}throw Error("Wallet not connected!");case 3:if(t){e.next=5;break}throw Error("Wallet does not support message signing!");case 5:return n=new TextEncoder().encode("Hello, world!"),e.next=8,t(n);case 8:if(s=e.sent,(0,C.T)(s,n,r.toBytes())){e.next=11;break}throw Error("Invalid signature!");case 11:(0,q.h)({type:"success",message:"Sign message successful!",txid:I().encode(s)}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),(0,q.h)({type:"error",message:"Sign Message failed!",description:null===e.t0||void 0===e.t0?void 0:e.t0.message}),console.log("error","Sign Message failed! ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message));case 18:case"end":return e.stop()}},e,null,[[0,14]])})),[r,q.h,t]);return(0,R.jsx)("div",{className:"flex flex-row justify-center",children:(0,R.jsxs)("div",{className:"relative group items-center",children:[(0,R.jsx)("div",{className:"m-1 absolute -inset-0.5 bg-gradient-to-r from-indigo-500 to-fuchsia-500  rounded-lg blur opacity-20 group-hover:opacity-100 transition duration-1000 group-hover:duration-200 animate-tilt"}),(0,R.jsxs)("button",{className:"group w-60 m-2 btn animate-pulse bg-gradient-to-br from-indigo-500 to-fuchsia-500 hover:from-white hover:to-purple-300 text-black",onClick:n,disabled:!r,children:[(0,R.jsx)("div",{className:"hidden group-disabled:block",children:"Wallet not connected"}),(0,R.jsx)("span",{className:"block group-disabled:hidden",children:"Sign Message"})]})]})})};function L(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}var V=function(){var e=(0,O.R)().connection,r=(0,j.O)(),t=r.publicKey,n=r.sendTransaction,s=(0,u.useCallback)((0,a.Z)(i().mark(function r(){var s,a,o,c,u;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t){r.next=4;break}return(0,q.h)({type:"error",message:"Wallet not connected!"}),console.log("error","Send Transaction: Wallet not connected!"),r.abrupt("return");case 4:return s="",r.prev=5,a=[k.SystemProgram.transfer({fromPubkey:t,toPubkey:k.Keypair.generate().publicKey,lamports:1e6})],r.next=9,e.getLatestBlockhash();case 9:return o=r.sent,c=new k.TransactionMessage({payerKey:t,recentBlockhash:o.blockhash,instructions:a}).compileToLegacyMessage(),u=new k.VersionedTransaction(c),r.next=14,n(u,e);case 14:return s=r.sent,r.next=17,e.confirmTransaction(function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?L(Object(t),!0).forEach(function(r){(0,p.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({signature:s},o),"confirmed");case 17:console.log(s),(0,q.h)({type:"success",message:"Transaction successful!",txid:s}),r.next=26;break;case 21:return r.prev=21,r.t0=r.catch(5),(0,q.h)({type:"error",message:"Transaction failed!",description:null===r.t0||void 0===r.t0?void 0:r.t0.message,txid:s}),console.log("error","Transaction failed! ".concat(null===r.t0||void 0===r.t0?void 0:r.t0.message),s),r.abrupt("return");case 26:case"end":return r.stop()}},r,null,[[5,21]])})),[t,q.h,e,n]);return(0,R.jsx)("div",{className:"flex flex-row justify-center",children:(0,R.jsxs)("div",{className:"relative group items-center",children:[(0,R.jsx)("div",{className:"m-1 absolute -inset-0.5 bg-gradient-to-r from-indigo-500 to-fuchsia-500  rounded-lg blur opacity-20 group-hover:opacity-100 transition duration-1000 group-hover:duration-200 animate-tilt"}),(0,R.jsxs)("button",{className:"group w-60 m-2 btn animate-pulse bg-gradient-to-br from-indigo-500 to-fuchsia-500 hover:from-white hover:to-purple-300 text-black",onClick:s,disabled:!t,children:[(0,R.jsx)("div",{className:"hidden group-disabled:block ",children:"Wallet not connected"}),(0,R.jsx)("span",{className:"block group-disabled:hidden",children:"Send Transaction"})]})]})})};function F(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}var J=function(){var e=(0,O.R)().connection,r=(0,j.O)(),t=r.publicKey,n=r.sendTransaction,s=(0,u.useCallback)((0,a.Z)(i().mark(function r(){var s,a,o,c,u;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t){r.next=4;break}return(0,q.h)({type:"error",message:"Wallet not connected!"}),console.log("error","Send Transaction: Wallet not connected!"),r.abrupt("return");case 4:return s="",r.prev=5,a=[k.SystemProgram.transfer({fromPubkey:t,toPubkey:k.Keypair.generate().publicKey,lamports:1e6})],r.next=9,e.getLatestBlockhash();case 9:return o=r.sent,c=new k.TransactionMessage({payerKey:t,recentBlockhash:o.blockhash,instructions:a}).compileToV0Message(),u=new k.VersionedTransaction(c),r.next=14,n(u,e);case 14:return s=r.sent,r.next=17,e.confirmTransaction(function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?F(Object(t),!0).forEach(function(r){(0,p.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({signature:s},o),"confirmed");case 17:console.log(s),(0,q.h)({type:"success",message:"Transaction successful!",txid:s}),r.next=26;break;case 21:return r.prev=21,r.t0=r.catch(5),(0,q.h)({type:"error",message:"Transaction failed!",description:null===r.t0||void 0===r.t0?void 0:r.t0.message,txid:s}),console.log("error","Transaction failed! ".concat(null===r.t0||void 0===r.t0?void 0:r.t0.message),s),r.abrupt("return");case 26:case"end":return r.stop()}},r,null,[[5,21]])})),[t,q.h,e,n]);return(0,R.jsx)("div",{className:"flex flex-row justify-center",children:(0,R.jsxs)("div",{className:"relative group items-center",children:[(0,R.jsx)("div",{className:"m-1 absolute -inset-0.5 bg-gradient-to-r from-indigo-500 to-fuchsia-500  rounded-lg blur opacity-20 group-hover:opacity-100 transition duration-1000 group-hover:duration-200 animate-tilt"}),(0,R.jsxs)("button",{className:"group w-60 m-2 btn animate-pulse bg-gradient-to-br from-indigo-500 to-fuchsia-500 hover:from-white hover:to-purple-300 text-black",onClick:s,disabled:!t,children:[(0,R.jsx)("div",{className:"hidden group-disabled:block ",children:"Wallet not connected"}),(0,R.jsx)("span",{className:"block group-disabled:hidden",children:"Send Versioned Transaction"})]})]})})},U=function(e){return(0,o.Z)(e),(0,R.jsx)("div",{className:"md:hero mx-auto p-4",children:(0,R.jsxs)("div",{className:"md:hero-content flex flex-col",children:[(0,R.jsx)("h1",{className:"text-center text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-br from-indigo-500 to-fuchsia-500 mt-10 mb-8",children:"Basics"}),(0,R.jsxs)("div",{className:"text-center",children:[(0,R.jsx)(D,{}),(0,R.jsx)(V,{}),(0,R.jsx)(J,{})]})]})})}}}]);